<script>
const chat=document.getElementById("chat");
let history=JSON.parse(localStorage.getItem("aatifAI"))||[];
let voice=window.speechSynthesis;

function speak(text){
  voice.cancel(); // purani awaaz band
  let u=new SpeechSynthesisUtterance(text);
  u.lang="hi-IN";
  u.rate=1;
  voice.speak(u);
}

function add(type,text,save=true,say=false){
 let d=document.createElement("div");
 d.className="msg "+type;
 d.innerHTML=text;
 chat.appendChild(d);
 chat.scrollTop=chat.scrollHeight;
 if(save){
  history.push({type,text});
  localStorage.setItem("aatifAI",JSON.stringify(history));
 }
 if(say) speak(text.replace(/<[^>]*>/g,""));
}

add("ai","Hello! Main <b>Mohd Aatif AI</b> hoon. Aap jo bhi poochna chahein, pooch sakte hain.",false,true);

function send(){
 let q=document.getElementById("q");
 let t=q.value.trim();
 if(!t) return;
 voice.cancel();
 add("user",t);
 q.value="";
 let l=t.toLowerCase();

 // ===== BACKUP ANSWERS =====

 if(l.includes("namaz")){
  add("ai","<b>Answer:</b> Namaz momin ki zindagi ka sabse bada farz hai. Namaz se dil ko sukoon, gunahon se hifazat aur Allah ki qurbat milti hai.",true,true);
 }

 else if(l.includes("quran")){
  add("ai","<b>Answer:</b> Quran Allah ki paak kitaab hai jo Hazrat Muhammad ï·º par nazil hui. Ye hidayat aur rehnumai ka zariya hai.",true,true);
 }

 else if(l.includes("dua")){
  add("ai","<b>Answer:</b> Dua Allah se seedhi baat karna hai. Dua se taqdeer bhi badal jaati hai.",true,true);
 }

 else if(l.includes("mohd aatif")){
  add("ai","<b>Answer:</b> Mohd Aatif ek digital creator aur Mohd Aatif AI ke founder hain.",true,true);
 }

 // ===== ONLINE MODE (RESULT / EXAM) =====

 else if(l.includes("up board 12")){
  add("ai","<b>Answer:</b> UP Board 12th result online check karein:<br>ðŸ”— <a href='https://upresults.nic.in' target='_blank'>upresults.nic.in</a>",true,true);
 }

 else if(l.includes("jee")){
  add("ai","<b>Answer:</b> JEE Main result yahan check karein:<br>ðŸ”— <a href='https://jeemain.nta.nic.in' target='_blank'>jeemain.nta.nic.in</a>",true,true);
 }

 // ===== CALCULATION =====
 else if(/^[0-9+\-*/(). ]+$/.test(l)){
  try{
   let r=eval(l);
   add("ai","<b>Answer:</b> "+r,true,true);
  }catch{
   add("ai","<b>Answer:</b> Calculation samajh nahi aayi.",true,true);
  }
 }

 // ===== UNKNOWN =====
 else{
  add("ai","<b>Answer:</b> Ye sawal backup me nahi hai. Online search ke liye neeche link use karein:<br>ðŸ”— <a href='https://www.google.com/search?q="+encodeURIComponent(t)+"' target='_blank'>Google Search</a>",true,true);
 }
}

function loadHistory(){
 chat.innerHTML="";
 history.forEach(m=>add(m.type,m.text,false));
}
</script>
